(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[11],{

/***/ "./public/components/EmojiReactions.js":
/*!*********************************************!*\
  !*** ./public/components/EmojiReactions.js ***!
  \*********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var emoji_mart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! emoji-mart */ \"./node_modules/emoji-mart/dist-es/index.js\");\n/* harmony import */ var emoji_mart_data_emojione_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! emoji-mart/data/emojione.json */ \"./node_modules/emoji-mart/data/emojione.json\");\nvar emoji_mart_data_emojione_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! emoji-mart/data/emojione.json */ \"./node_modules/emoji-mart/data/emojione.json\", 1);\nfunction _typeof2(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n} // Dex last merged this code on 13th jan 2021\n\n\n\n\n\n\nvar EmojiReactions = /*#__PURE__*/function (_Component) {\n  _inherits(EmojiReactions, _Component);\n\n  function EmojiReactions() {\n    var _this;\n\n    _classCallCheck(this, EmojiReactions);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(EmojiReactions).call(this));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"toggleEmojis\", function (e) {\n      e.persist();\n      var showEmojis = _this.state.showEmojis;\n      var currentState = showEmojis;\n\n      _this.setState({\n        showEmojis: !currentState\n      }, function () {\n        if (_this.state.showEmojis === true) {\n          _this.toggleMsgHover(e);\n\n          document.addEventListener('mousedown', _this.closeMenu); // Check if message is positioned too near the bottom of screen (i.e. won't fit the EmojiPicker box)\n\n          var dropZone = document.getElementById('drop-zone');\n          var el = e.target.closest('.block-container');\n          var elOffsetTop = el.offsetTop;\n          var parentOffsetTop = dropZone.offsetTop; // position from top of it's parent\n\n          var parentClientHeight = dropZone.clientHeight; // Visible part of DropZone\n\n          var parentScrollTop = dropZone.scrollTop; // How much have scrolled down\n\n          var parentScrollHeight = dropZone.scrollHeight; // Entire height of DropZone (even bits of screen)\n\n          var emojiPickerHeight = 423; // 423px\n\n          var emojiPickerWidth = 346; // 346px\n\n          var blockHeightLessReactions = el.scrollHeight - e.target.scrollHeight;\n          var spaceBelow = parentScrollHeight - elOffsetTop - blockHeightLessReactions;\n          var spaceAbove = parentClientHeight - spaceBelow;\n          var nearBottomOfDiv = spaceBelow < emojiPickerHeight;\n          var spaceToRight = e.target.closest('.message-container').offsetWidth - e.target.closest('.addReaction').offsetLeft;\n          var spaceToLeft = e.target.closest('.addReaction').offsetLeft;\n          var screenWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth; // If not on mobile (where diff formatting applies)\n\n          if (screenWidth > 500) {\n            var addMsgReaction = document.querySelector('.emojiPickerContainer.msgReactions'); // SORT VERTICAL POSITIONING\n            // If near bottom of div, there is no space to show below so show above\n\n            if (nearBottomOfDiv == true) {\n              addMsgReaction.style.top = \"-\" + (emojiPickerHeight + 10) + \"px\"; // If elsewhere in div, if not enough space below check enough space above (otherwise will just show it below and user has to scroll a little)\n            } else if (spaceBelow < emojiPickerHeight && spaceAbove >= emojiPickerHeight) {\n              // Make EmojiPicker appear above button just clicked but taking as much space below as poss\n              //addMsgReaction.style.top = \"-\" + ((emojiPickerHeight - spaceBelow) + btnOffsetTop) + \"px\"\n              //addMsgReaction.style.top = \"-\" + ((emojiPickerHeight - spaceBelow) - (el.offsetHeight - reactionsBarHeight)) + \"px\"\n              addMsgReaction.style.top = \"-\" + (emojiPickerHeight - spaceBelow) + \"px\";\n            } // SORT HORIZONTAL POSITIONING\n            // If not enough space to the right\n\n\n            if (spaceToRight < emojiPickerWidth) {\n              // Make EmojiPicker appear to left of button just clicked but taking as much space left as poss + 15px margin\n              addMsgReaction.style.left = \"-\" + (emojiPickerWidth - spaceToRight + 15) + \"px\";\n            }\n          }\n        } else {\n          _this.toggleMsgHover(e);\n\n          document.removeEventListener('mousedown', _this.closeMenu);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleEmojiClick\", function (evt) {\n      alert(evt.colons + ' clicked');\n      var msgID = _this.props.msgID;\n      /* If ({evt.colons} doesnt exist in message.reactions list for {msgID}) {\r\n           add new reaction for {msgID} i.e. (reaction.name = {evt.colons}, reaction.users = {myUID}, reaction.count = 1)\r\n         } else if (I {myUID} am already on the list of reaction.users) {\r\n             if (reaction.count = 1) {\r\n               delete reaction from list entirely for {msgID}\r\n             } else {\r\n               remove {myUID} from reaction.users and decrease count by 1 for {msgID}\r\n             }\r\n         } else if {\r\n           add {myUID} to reaction.users list and increase count by 1 for {msgID}\r\n         }\r\n      */\n\n      _this.setState({\n        showEmojis: false\n      }, function () {\n        _this.toggleMsgHover();\n\n        document.removeEventListener('mousedown', _this.closeMenu);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"closeMenu\", function (e) {\n      if (_this.emojiPicker !== null && !_this.emojiPicker.contains(e.target) && !_this.emojiPicker.closest('.addReaction').contains(e.target)) {\n        _this.setState({\n          showEmojis: false\n        }, function () {\n          document.removeEventListener('mousedown', _this.closeMenu);\n\n          _this.toggleMsgHover();\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"closeOnEsc\", function (e) {\n      var key = e.key || e.keyCode;\n\n      if (key === 'Escape' || key === 'Esc' || key === 27) {\n        e.persist();\n\n        _this.setState({\n          showEmojis: false\n        });\n\n        _this.toggleMsgHover(e);\n\n        document.removeEventListener('mousedown', _this.closeMenu);\n\n        _this.addReactionNode.focus();\n      } else {\n        return;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleReactionClick\", function (userClicked, emojiName) {\n      var msgID = _this.props.msgID;\n\n      if (userClicked == true) {\n        alert('removing user from ' + emojiName);\n        /* if (reaction.count = 1) {\r\n             delete reaction from list entirely for {msgID}\r\n           } else {\r\n             remove {myUID} from reaction.users and decrease count by 1 for {msgID}\r\n           }\r\n        */\n      } else {\n        alert('adding user to ' + emojiName); // add {myUID} to reaction.users list and increase count by 1 for {msgID}\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"toggleMsgHover\", function (e) {\n      if (e) {\n        e.target.closest('.block-container').classList.toggle('keepHover'); // If relates to remove event listener i.e. where can't use e.persist()\n      } else {\n        document.querySelector('.block-container.keepHover').classList.toggle('keepHover');\n      }\n    });\n\n    _this.state = {\n      showEmojis: false\n    };\n    return _this;\n  }\n\n  _createClass(EmojiReactions, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var showEmojis = this.state.showEmojis;\n      var reactions = this.props.reactions;\n      var myUID = '223457';\n      var sortedArray = reactions.sort(function (a, b) {\n        return b.count - a.count;\n      });\n      var reactionsArray;\n      reactionsArray = sortedArray.map(function (reaction, index) {\n        var userClicked = reaction.users.includes(myUID);\n        var emojiCount = reaction.count;\n        return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n          className: \"emojiReaction\" + (userClicked ? ' userClicked' : ''),\n          key: index\n        }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n          className: \"emojiReaction-btn tooltip\" + (userClicked ? ' userClicked' : ''),\n          onClick: function onClick() {\n            return _this2.handleReactionClick(userClicked, reaction.name);\n          },\n          onKeyDown: function onKeyDown() {\n            return _this2.handleReactionClick(userClicked, reaction.name);\n          }\n        }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n          className: \"emojiReaction-icon\"\n        }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(emoji_mart__WEBPACK_IMPORTED_MODULE_1__[\"Emoji\"], {\n          emoji: reaction.name,\n          size: 17\n        }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n          className: \"reactionCount\"\n        }, reaction.count)), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n          className: \"tooltiptext emojiReactions\"\n        }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n          className: \"emojiIconTooltip-Container\"\n        }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(emoji_mart__WEBPACK_IMPORTED_MODULE_1__[\"Emoji\"], {\n          emoji: reaction.name,\n          size: 30\n        })), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", null, userClicked ? 'You (click to remove)' : 'XXX', emojiCount > 1 ? emojiCount > 2 ? ', YYY and others' : ' and YYY' : '', react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n          className: \"whiteFadedText noBold\"\n        }, \" reacted with \", reaction.name)))));\n      });\n      return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment, null, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n        className: \"emojiReactions-container\"\n      }, reactionsArray, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n        className: \"addReaction\"\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"button\", {\n        type: \"button\",\n        className: \"emojiReaction-btn tooltip\",\n        onClick: this.toggleEmojis,\n        onKeyDown: this.toggleEmojis,\n        ref: function ref(n) {\n          return _this2.addReactionNode = n;\n        }\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n        className: \"addReaction-icon\"\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"i\", {\n        className: \"hideOnHover far fa-smile\"\n      }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"i\", {\n        className: \"showOnHover fas fa-laugh\"\n      })), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"svg\", {\n        width: \"5px\",\n        height: \"5px\",\n        viewBox: \"0 0 10 10\",\n        className: \"plusSign addEmoji-bar\"\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"line\", {\n        className: \"\",\n        x1: \"0\",\n        x2: \"10\",\n        y1: \"5\",\n        y2: \"5\"\n      }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"line\", {\n        className: \"\",\n        x1: \"5\",\n        x2: \"5\",\n        y1: \"0\",\n        y2: \"10\"\n      })), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n        className: \"tooltiptext last emojiReactions\"\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, \"Add reaction...\"))), showEmojis &&\n      /* The <div> element is just used as a container for EmojiPicker */\n\n      /* eslint-disable-next-line jsx-a11y/no-static-element-interactions */\n      react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n        className: \"emojiPickerContainer msgReactions\",\n        ref: function ref(el) {\n          return _this2.emojiPicker = el;\n        },\n        onKeyDown: this.closeOnEsc\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(emoji_mart__WEBPACK_IMPORTED_MODULE_1__[\"NimblePicker\"], {\n        onSelect: this.handleEmojiClick,\n        data: emoji_mart_data_emojione_json__WEBPACK_IMPORTED_MODULE_2__,\n        title: \"Pick your emoji\\u2026\",\n        emoji: \"point_up\",\n        set: \"emojione\",\n        autoFocus: true\n      })))));\n    }\n  }]);\n\n  return EmojiReactions;\n}(react__WEBPACK_IMPORTED_MODULE_0__[\"Component\"]);\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (EmojiReactions);\n\n//# sourceURL=webpack:///./public/components/EmojiReactions.js?");

/***/ })

}]);